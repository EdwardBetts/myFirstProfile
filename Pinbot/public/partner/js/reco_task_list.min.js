(function(){var e=angular.module("taskListApp",["ui.router","app.config","app.filter"]),c=angular.injector(["app.utils","app.django"]),b=c.get("id_url"),a=c.get("tmpl"),d=c.get("static_url");e.config(["$stateProvider","$urlRouterProvider",function(g,f){f.otherwise("/list");g.state("list",{url:"/list?query&page",controller:"listCtrl",templateUrl:a("partner/task_list.html")});}]);e.controller("taskListCtrl",["$scope","$http","$state","$location","$rootScope","$compile",function(g,k,i,j,f,h){g.page=j.$$search.page||1;g.query=j.$$search.query||"";g.search=function(){angular.element("[ui-view]").html("");g.page=1;i.go("list",{query:g.query,page:g.page});};g.showViewDesc=true;g.viewFeed=false;g.toggleView=function(l){g.viewFeed=l;};g.showFeed=function(l,m){if(angular.element(m.target).hasClass("JS_view_desc")){return false;}g.toggleView(true);g.feedData={task:l,feed:l.feed,company:l.feed.company};g.refresh();};g.toogleBackdrop=function(l){g.showBackdrop=l;};g.isShowLayer=function(l,m){g.viewFeed=false;g.toogleBackdrop(true);g.upload_url="/partner/edit_resume/?task_id="+m;g.select_url="/partner/resume_manage/#/manage_preview/"+m+"/";l.stopPropagation();};g.toggleDesc=function(){g.showViewDesc=!g.showViewDesc;g.refresh();};g.refresh=function(){if(!g.viewFeed){return;}setTimeout(function(){$(".modal-dialog-view").css({marginTop:($(window).height()-$(".modal-dialog-view").height())/2+"px"});},0);};g.toViewResume=function(m){var l="/resumes/display/"+m.resume_id+"/?feed_id="+m.feed_id,n=window.open();n.opener=null;n.open("","_self","");n.location=l;};g.loadMoreFun=function(){if($(document).height()-$(window).height()-$(document).scrollTop()>100){return false;}if(f.loading){return false;}if(g.page>=f.pages){return false;}f.loading=true;g.page++;var l=h('<load-more page="'+g.page+'"></load-more>')(g);angular.element("[ui-view]").append(l);};angular.element(window).on("scroll",g.loadMoreFun);}]);e.controller("listCtrl",["$scope","$http","$stateParams","$rootScope",function(g,i,h,f){g.query=h.query;g.page=g.page||1;f.loading=true;g.showBackdrop=false;g.followResume=function(j){j.stopPropagation();};g.stopPropagation=function(j){j.stopPropagation();};i.get("/partner/accept_task_list/",{params:{query:g.query,page:g.page,___:new Date().getTime()}}).success(function(j){if(j&&j.data&&j.data.length){f.pages=j.pages;g.data=j.data;f.noAnyData=false;}else{if(g.page==1){f.noAnyData=true;}else{f.noAnyData=false;}}f.loading=false;}).error(function(){f.loading=false;if(g.page==1){f.noAnyData=true;}});}]);e.directive("ngEnter",function(){return function(h,g,f){g.bind("keydown keypress",function(i){if(i.keyCode===13){h.$apply(function(){h.$eval(f.ngEnter);});i.preventDefault();}});};});e.directive("loadMore",function(){return{restrict:"E",controller:"listCtrl",scope:true,templateUrl:a("partner/task_list.html")};});})();$(function(){$.Tip({selector:".JS_view_desc",cssText:"width:400px;",success:function(b){var g=this,a=$("#JS_tip_model"),e="",h=b.data;if(!a.length){return false;}if(h.length){e+='<table cellpadding="0" cellspacing="0" class="ajax-tip-list" width="100%">';for(var d=0,c=h.length;d<c;d++){var f=h[d];e+="<tr><td>"+f.record_time+"</td><td>"+f.resume_name+"</td><td>"+f.desc+'</td><td><span style="color:#'+(f.coin>=0?"45b5e9":"f46c62")+';font-family:arial;">'+f.coin+"</span>金币</td></tr>";}e+="</table>";}else{e+='<p class="text-center">暂无数据！</p>';}e+='<p class="tip-pages clearfix">';if(b.current>1){e+='<a class="JS_tip_page" href="javascript:;" data-url="'+this.setting.url+'" data-page="'+(b.current-1)+'">上一页</a>';}if(b.current<b.pages){e+='<a class="JS_tip_page" href="javascript:;" data-url="'+this.setting.url+'" data-page="'+(b.current+1)+'">下一页</a>';}e+="</p>";a.html(e);this.setPosition(g.setting.eventTarget);$(".JS_tip_page").on("click",function(){g.loadData(this);});}});});