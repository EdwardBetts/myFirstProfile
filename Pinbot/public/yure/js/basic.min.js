$.LayerOut=function(a){return new $.LayerOut.prototype.init(a);};$.LayerOut.prototype={constructor:$.LayerOut,version:"1.0",init:function(a){if($._LayerOut){delete $._LayerOut;}$(".modal-backdrop,.modal").remove();this.setting=a=$.extend({title:"",html:"",dialogCss:"",closeByShadow:true,confirmByShadow:false,handlers:[],callback:null},a);$._LayerOut=this;$._LayerOut.getHtml();if(typeof $._LayerOut.setting.callback=="function"){$._LayerOut.setting.callback();}},getHtml:function(){setting=this.setting;var f='<div class="modal-backdrop fade in"></div><div class="modal" id="myModal" tabindex="-1" style="display: block;"><div class="modal-dialog" style="'+this.setting.dialogCss+'"><div class="modal-content" id="JS_modal_content">'+(this.setting.title?'<div class="modal-header clearfix"><h4 class="modal-title Left" id="myModalLabel">'+this.setting.title+'</h4><span class="Right">'+(this.setting.date?this.setting.date:"")+"</span></div>":"")+'<div class="modal-body">'+this.setting.html+"</div></div></div></div>";$("body").append(f);if(setting.handlers.length){var k=$('<div class="modal-handle"></div>');for(var e=0,b=setting.handlers.length;e<b;e++){var c=setting.handlers[e],a=$('<a class="'+c.className+'">'+c.title+"</a>");a.on(c.eventType,c.event);k.append(a);}}$("#JS_modal_content").append(k);var g=$(".modal-dialog"),j=g.height(),d=$(window).height();g.css("marginTop",(d-j)/2+"px");$(".JS_close_layerout").on("click",this.close);var h=this;$("#myModal").on("click",function(l){l=l||window.event;var i=l.target||l.srcElement;if(l.target!=this){return;}if(setting.handlers.length&&setting.confirmByShadow){setting.handlers[0].event();}else{if(setting.closeByShadow){h.close();}}});},close:function(){$(".modal-backdrop,.modal").remove();delete $._LayerOut;}};$.LayerOut.prototype.init.prototype=$.LayerOut.prototype;$.alert=function(b,a,d,c){var c=$.extend({title:d||"提示",html:b||"请确认！",handlers:[{title:"确定",eventType:"click",confirmByShadow:false,className:"layer-button blue-button",event:function(){if(typeof a=="function"){a();}$._LayerOut.close();}}]},c);$.LayerOut(c);};$.confirm=function(b,a,e,d,c){var c=$.extend({title:d||"提示",html:b||"请确认！",handlers:[{title:"确定",eventType:"click",className:"layer-button blue-button",event:function(){if(typeof a=="function"){a();}$._LayerOut.close();}},{title:"取消",eventType:"click",className:"layer-button grey-button",event:function(){if(typeof e=="function"){e();}$._LayerOut.close();}}]},c);$.LayerOut(c);};jQuery.prototype.serializeObject=function(){var a=new Object();$.each(this.serializeArray(),function(b,c){if(!(c.name in a)){a[c.name]=c.value;}});return a;};$.Click=(function(b,c){var a=function(d){return new a.prototype.init(d);};a.prototype={constructor:a,init:function(d){this.setting=b.extend({dom:"",before:null,isOk:true,lock:true,unlock:function(){b(this.setting.dom).removeClass("locked-click");},callback:null},d);if(this.setting.lock){b(this.setting.dom).addClass("locked-click");}if(typeof this.setting.before=="function"){this.setting.isOk=this.setting.before();}if(this.setting.isOk){this.setting.callback.call(this);}else{this.setting.unlock.call(this);}}};a.prototype.init.prototype=a.prototype;return function(d){if(!d||!d.dom||b(d.dom).hasClass("locked-click")){return;}return a(d);};})(jQuery);$.Ajax=(function(b,c){var a=function(d){return new a.prototype.init(d);};a.prototype={constructor:a,init:function(d){this.setting=d=b.extend({url:"",form:"",callDom:"",method:"post",isOk:true,data:"",failed:function(){b.alert('<p style="text-align:center;font-size:16px;"><i class="i-l-notice"></i>请求失败了，刷新再试一下吧！</p>');},successed:function(g){if(this.setting.callback&&typeof this.setting.callback=="function"){this.setting.callback(g);}else{if(g&&g.status=="ok"){b.alert('<p style="text-align:center;font-size:16px;"><i class="i-l-notice"></i>操作成功！</p>');}else{if(g&&g.msg){b.alert('<p style="text-align:center;font-size:16px;"><i class="i-l-notice"></i>'+g.msg+"</p>");}else{b.alert('<p style="text-align:center;font-size:16px;"><i class="i-l-notice"></i>请求失败了，刷新再试一下吧！</p>');}}}},verify:null,callback:null},d);var f=b(this.setting.form),e=this;if(this.setting.verify){this.setting.isOk=this.setting.verify();}if(f&&!this.setting.data){this.setting.data=b(this.setting.form).serializeObject();}if(this.setting.isOk){this.setting.data.___=new Date().getTime();window._commonAjax=b[this.setting.method](this.setting.url,this.setting.data,function(g){e.setting.successed.call(e,g);e.unlock();window._commonAjax=null;}).fail(function(){e.setting.failed.call(e);e.unlock();});}else{e.unlock();}},unlock:function(){if(this.setting.callDom){b(this.setting.callDom).removeClass("locked-click");}}};a.prototype.init.prototype=a.prototype;return function(d){return a(d);};})(jQuery);$.commonAjax=function(){if(window._commonAjax){window._commonAjax.abort();window._commonAjax=null;}var g=this,h=$(this),k=h.attr("data-before"),i=h.attr("data-ajax_common_type"),j=h.attr("data-ajax_verify"),d=h.attr("data-callback"),a=h.attr("data-method"),f=h.hasClass("locked-click"),c="",b="",e={callDom:g};if(f){return false;}if(i=="normal"){b=h.attr("data-ajax_url");a=a||"get";e.data=$.extend(true,{},h.data());delete e.data.ajax_url;delete e.data.before;delete e.data.ajax_common_type;delete e.data.ajax_verify;delete e.data.callback;delete e.data.method;}else{c=h.attr("data-form")?$(h.attr("data-form")):h.closest("form");b=c.attr("data-ajax_url")||c.attr("action");a=a||"post";e.form=c;}if(j&&typeof window[j]=="function"){e.verify=function(){return window[j](c);};}if(d&&typeof window[d]=="function"){e.callback=window[d];}e.url=b;e.method=a;$.Click({dom:g,before:window[k],callback:function(){$.Ajax(e);}});};filterXss=function(c){var a=/<script>|<\/script>/igm,b=function(e,d){e=e.replace(/</g,"&lt;");e=e.replace(/>/g,"&gt;");return e;};c=c.replace(a,b);return c;};$.loadBgImg=function(d){d=$.extend({attr:"data-bg",loadImg:function(f,g){var h=new Image();h.onload=h.onerror=function(){f.css("backgroundImage","url("+g+")").removeAttr("data-bg");h=null;};h.src=g;},imgList:[],callback:null},d);if(!d.imgList.length){d.imgList=$("["+d.attr+"]");}var e=d.imgList;if(!e.length){return;}for(var c=0;c<e.length;c++){var b=$(e[c]),a=b.attr(d.attr);if(!a){continue;}d.loadImg(b,a);}if(typeof d.callback=="function"){d.callback();}};$.lazyImg=function(a){return new $.lazyImg.prototype.init(a);};$.lazyImg.prototype={constructor:$.lazyImg,imgList:[],loadingList:[],init:function(a){this.setting=$.extend({attr:"data-src",loadType:1,count:30,scrollLimit:30,isLock:false,scrollTop:0,scrollBorder:60,callback:null},a);this.imgList=$("img["+this.setting.attr+"]");window._lazy=this;this.getPositionByBody();this.start();$(window).on("scroll",window,window._lazy.scroll);},start:function(){var d=_lazy.getList();for(var c=0;c<d.length;c++){var a=d[c],b=$(a),e=b.attr(_lazy.setting.attr);_lazy.loadImg(b,e);_lazy.loadingList.push(a);}_lazy.resetImgFromImgList();},getList:function(){var c=[];if(_lazy.setting.loadType==1){var b=$(window).scrollTop(),e=$(window).height();for(var d=0;d<_lazy.imgList.length;d++){var f=$(_lazy.imgList[d]).offset().top;if(f<(b+e+_lazy.setting.scrollBorder)){c.push(_lazy.imgList[d]);_lazy.filterImg(d);}}}else{var a=_lazy.imgList.length>this.setting.count?this.setting.count:_lazy.imgList.length;for(var d=0;d<a.length;d++){c.push(_lazy.imgList[d]);_lazy.filterImg(d);}}return c;},filterImg:function(a){_lazy.imgList[a].top=null;delete _lazy.imgList[a];},loadImg:function(a,c){var b=new Image();b.onload=b.onerror=function(){a.attr("src",c).removeAttr(_lazy.setting.attr);_lazy.clearImgFromLoadingList(a[0]);b=null;};b.src=c;},getPositionByBody:function(){for(var a=0;a<_lazy.imgList.length;a++){var b=$(_lazy.imgList[a]).offset().top;_lazy.imgList[a].top=b;}},resetImgFromImgList:function(){var a=[];for(var b=0;b<_lazy.imgList.length;b++){var c=_lazy.imgList[b];if(c){a.push(c);}}_lazy.imgList=a;_lazy.timmer();},clearImgFromLoadingList:function(a){for(var b=0;b<_lazy.loadingList.length;b++){if(_lazy.loadingList[b]==a){_lazy.loadingList.splice(b,1);return;}}},scroll:function(){if(_lazy.setting.isLock){return false;}_lazy.setting.isLock=true;if(!_lazy.imgList||!_lazy.imgList.length){window._lazy.complete();return false;}_lazy.start();},timmer:function(){var a=function(){_lazy.setting.isLock=false;};tLazy=setTimeout(a,_lazy.setting.scrollLimit);},complete:function(){$(window).off("scroll",window._lazy.scroll);_lazy.setting.isLock=false;tLazy&&clearTimeout(tLazy);if(typeof _lazy.setting.callback=="function"){_lazy.setting.callback();}_lazy=null;}};$.lazyImg.prototype.init.prototype=$.lazyImg.prototype;