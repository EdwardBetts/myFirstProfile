$.loadBgImg=function(t){t=$.extend({attr:"data-bg",loadImg:function(t,i){var e=new Image;e.onload=e.onerror=function(){t.css("backgroundImage","url("+i+")").removeAttr("data-bg"),e=null},e.src=i},imgList:[],callback:null},t),t.imgList=$("["+t.attr+"]");var i=t.imgList;if(i.length){for(var e=0;e<i.length;e++){var s=$(i[e]),n=s.attr(t.attr);n&&t.loadImg(s,n)}"function"==typeof t.callback&&t.callback()}},$.lazyImg=function(t){return new $.lazyImg.prototype.init(t)},$.lazyImg.prototype={constructor:$.lazyImg,imgList:[],loadingList:[],init:function(t){this.setting=$.extend({attr:"data-src",loadType:1,count:30,scrollLimit:30,isLock:!1,scrollTop:0,scrollBorder:60,callback:null},t),this.imgList=$("img["+this.setting.attr+"]"),window._lazy=this,this.getPositionByBody(),this.start(),$(window).on("scroll",window,window._lazy.scroll)},start:function(){for(var t=_lazy.getList(),i=0;i<t.length;i++){var e=t[i],s=$(e),n=s.attr(_lazy.setting.attr);_lazy.loadImg(s,n),_lazy.loadingList.push(e)}_lazy.resetImgFromImgList()},getList:function(){var t=[];if(1==_lazy.setting.loadType)for(var i=$(window).scrollTop(),e=$(window).height(),s=0;s<_lazy.imgList.length;s++){var n=$(_lazy.imgList[s]).offset().top;n<i+e+_lazy.setting.scrollBorder&&(t.push(_lazy.imgList[s]),_lazy.filterImg(s))}else for(var a=_lazy.imgList.length>this.setting.count?this.setting.count:_lazy.imgList.length,s=0;s<a.length;s++)t.push(_lazy.imgList[s]),_lazy.filterImg(s);return t},filterImg:function(t){_lazy.imgList[t].top=null,delete _lazy.imgList[t]},loadImg:function(t,i){var e=new Image;e.onload=e.onerror=function(){t.attr("src",i).removeAttr(_lazy.setting.attr),_lazy.clearImgFromLoadingList(t[0]),e=null},e.src=i},getPositionByBody:function(){for(var t=0;t<_lazy.imgList.length;t++){var i=$(_lazy.imgList[t]).offset().top;_lazy.imgList[t].top=i}},resetImgFromImgList:function(){for(var t=[],i=0;i<_lazy.imgList.length;i++){var e=_lazy.imgList[i];e&&t.push(e)}_lazy.imgList=t,_lazy.timmer()},clearImgFromLoadingList:function(t){for(var i=0;i<_lazy.loadingList.length;i++)if(_lazy.loadingList[i]==t)return void _lazy.loadingList.splice(i,1)},scroll:function(){return _lazy.setting.isLock?!1:(_lazy.setting.isLock=!0,_lazy.imgList&&_lazy.imgList.length?void _lazy.start():(window._lazy.complete(),!1))},timmer:function(){var t=function(){_lazy.setting.isLock=!1};tLazy=setTimeout(t,_lazy.setting.scrollLimit)},complete:function(){$(window).off("scroll",window._lazy.scroll),_lazy.setting.isLock=!1,tLazy&&clearTimeout(tLazy),"function"==typeof _lazy.setting.callback&&_lazy.setting.callback(),_lazy=null}},$.lazyImg.prototype.init.prototype=$.lazyImg.prototype,$.Animate=function(t){return new $.Animate.prototype.init(t)},$.Animate.prototype={constructor:$.Animate,init:function(t){this.setting=$.extend({type:"slide",leftBtn:"#JS_left_btn",rightBtn:"#JS_right_btn",listBox:"#JS_slide_list",cursor:"#JS_ppt_nav",mouseType:"click",current:"active",needPage:!1,index:0,autoPlay:!0,tag:"li",delay:3e3,spendTime:500,fadeEndTime:1e3,before:null,after:null},t),"function"==typeof this.setting.before&&this.setting.before();var i=$(this.setting.listBox);this.setting.length=i.find(this.setting.tag).length,i.css("width",i.parent().width()*this.setting.length+"px"),this.setting.needPage&&this.addSwitchPage();var e=this;"slide"==this.setting.type&&($(this.setting.leftBtn).on(this.setting.mouseType,function(){clearInterval(window[e.setting.timeOut]),e.prev(),e.animate()}),$(this.setting.rightBtn).on(this.setting.mouseType,function(){clearInterval(window[e.setting.timeOut]),e.next(),e.animate()})),("fade"==this.setting.type||this.setting.needPage)&&($(i).find(this.setting.tag).eq(0).css("opacity",1),$(this.setting.cursor+" a").eq(0).addClass(this.setting.current),$(this.setting.cursor+" a").on(this.setting.mouseType,function(){clearInterval(window[e.setting.timeOut]),e.setting.index=$(this).index(),e.getIndex=!0;var t=($(this).index(),$(this).siblings(".active").index());return e.setting.lastIndex=t,$(this).addClass(e.setting.current),$(this).siblings("."+e.setting.current).removeClass(e.setting.current),e.animate(),!1})),this.setting.autoPlay&&this.timeOut()},prev:function(){this.setting.index--,this.getIndex=!0},next:function(){this.setting.index++,this.getIndex=!0},timeOut:function(){var t=this;if(!this.setting.timeOut){var i="timeOut"+(new Date).getTime().toString("16")+Math.random();this.setting.timeOut=i}window[this.setting.timeOut]=setInterval(function(){t.animate()},this.setting.delay)},isOuter:function(){(this.setting.index>=this.setting.length||this.setting.index<0)&&(this.setting.index=0)},addSwitchPage:function(){if(!$(this.setting.cursor).html()){for(var t=$(this.setting.listBox).find("li").length,i="",e=0;t>e;e++)i+='<a href="javascript:;" '+(0==e?'class="active"':"")+">"+(e+1)+"</a>";$(this.setting.cursor).html(i)}},animate:function(){if(this.getIndex||this.setting.index++,this.isOuter(),"slide"==this.setting.type){var t=$(this.setting.listBox).width(),i=-t/this.setting.length*this.setting.index;$(this.setting.listBox).animate({left:i+"px"},this.setting.spendTime),this.setting.needPage&&$(this.setting.cursor+" a").eq(this.setting.index).addClass(this.setting.current).siblings("."+this.setting.current).removeClass(this.setting.current)}if("fade"==this.setting.type){var e,s=$(this.setting.listBox).find(this.setting.tag);e=this.getIndex?this.setting.lastIndex:this.setting.index-1,$(this.setting.cursor+" a").eq(this.setting.index).addClass(this.setting.current).siblings("."+this.setting.current).removeClass(this.setting.current),s.eq(e).animate({opacity:0},this.setting.spendTime),s.eq(this.setting.index).animate({opacity:1},this.setting.fadeEndTime)}"function"==typeof this.setting.after&&this.setting.after(this.setting.index),this.getIndex&&(this.getIndex=null,this.setting.autoPlay&&this.timeOut())}},$.Animate.prototype.init.prototype=$.Animate.prototype,$.LayerOut=function(t){return new $.LayerOut.prototype.init(t)},$.LayerOut.prototype={constructor:$.LayerOut,version:"1.0",init:function(t){$._LayerOut&&delete $._LayerOut,$(".modal-backdrop,.modal").remove(),this.setting=t=$.extend({onSubmit:null,onCancel:!0,title:"提示",html:"",callback:null},t),$._LayerOut=this,this.getHtml(),this.addEvent(),"function"==typeof this.setting.callback&&this.setting.callback()},getHtml:function(){setting=this.setting;var t='<div class="modal-backdrop fade in"></div><div class="modal" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true" style="display: block;"><div class="modal-dialog"><div class="modal-content" id="JS_modal_content">'+(this.setting.title?'<div class="modal-header clearfix"><h4 class="modal-title Left" id="myModalLabel">'+this.setting.title+'</h4><span class="Right">'+(this.setting.date?this.setting.date:"")+"</span></div>":"")+'<div class="modal-body"><p style="padding:20px">'+this.setting.html+"</p></div></div></div></div>";$("body").append(t);var i=$(".modal-dialog"),e=i.height(),s=$(window).height();i.css("marginTop",(s-e)/2+"px")},addEvent:function(){$(".JS_close_layerout").on("click",this.close),$(".JS_submit_layerout").on("click",this.setting.onSubmit);var t=this;$("#myModal").on("click",function(i){i=i||window.event;i.target||i.srcElement;i.target==this&&t.close()})},close:function(){$(".modal-backdrop,.modal").remove(),delete $._LayerOut}},$.LayerOut.prototype.init.prototype=$.LayerOut.prototype,$.fn.viewPhoto=function(t){t=$.extend({width:860,contentBox:"#viewPhoto",height:525,showClose:!0,attr:"data-src"},t),this.on("click",function(){var i,e=$(this).attr(t.attr);if(e.lastIndexOf)i=e.substring(e.lastIndexOf("."),e.length);else{var s=e.split(".");i=s[s.length-1]}var n="",a=$(document).height(),o=$(window).scrollTop();switch($("#viewPhoto,#JS_viewPhoto_bg").remove(),n='<div class="viewPhoto" id="viewPhoto" style="width:'+t.width+"px; height:"+t.height+"px; top:"+(o+($(window).height()-t.height)/2)+'px"><a class="a-icon i-close-viewPhoto" onclick="$(\'#viewPhoto,#JS_viewPhoto_bg\').remove();"></a>',i){case".swf":n+='<object id="FlashID" classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" width="'+t.width+'" height="'+t.height+'"><param name="movie" value="'+e+'" /><param name="quality" value="high" /><param name="wmode" value="opaque" /><param name="swfversion" value="6.0.65.0" /><!-- 此 param 标签提示使用 Flash Player 6.0 r65 和更高版本的用户下载最新版本的 Flash Player。如果您不想让用户看到该提示，请将其删除。 --><param name="expressinstall" value="Scripts/expressInstall.swf" /><!-- 下一个对象标签用于非 IE 浏览器。所以使用 IECC 将其从 IE 隐藏。 --><!--[if !IE]>--><object type="application/x-shockwave-flash" data="'+e+'" width="'+t.width+'" height="'+t.height+'"><!--<![endif]--><param name="quality" value="high" /><param name="wmode" value="opaque" /><param name="swfversion" value="6.0.65.0" /><param name="expressinstall" value="Scripts/expressInstall.swf" /><!-- 浏览器将以下替代内容显示给使用 Flash Player 6.0 和更低版本的用户。 --><div><h4>此页面上的内容需要较新版本的 Adobe Flash Player。</h4><p><a href="http://www.adobe.com/go/getflashplayer"><img src="http://www.adobe.com/images/shared/download_buttons/get_flash_player.gif" alt="获取 Adobe Flash Player" width="112" height="33" /></a></p></div><!--[if !IE]>--></object><!--<![endif]--></object>';break;case".other":n+="<div>others</div>";break;default:n+='<div><img src="'+e+'" alt="" style="max-width: 100%; margin: 0 auto; display: block;"/></div>'}return n+='</div><div class="viewPhoto-bg" id="JS_viewPhoto_bg" style="height:'+a+'px" onclick="$(\'#viewPhoto,#JS_viewPhoto_bg\').remove();"></div>',$("body").append(n),!1})},$(function(){$.loadBgImg(),$.lazyImg()});