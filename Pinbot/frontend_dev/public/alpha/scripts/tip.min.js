$.Tip=function(c,a){var b=function(d){return new b.prototype.init(d);};b.prototype={constructor:b,init:function(d){this.setting=d=c.extend({selector:".JS_tip_a",mouseHandle:"click",cssText:"",closeWay:"clickOutSide",success:null,content:"",className:"",needAjax:true,callback:null},d);var e=this;window.__tip=this;c(document).on(d.mouseHandle,d.selector,function(f){if(c(this).hasClass("JS_sock_tip")){return false;}c(".JS_sock_tip").not(c(this)).removeClass("JS_sock_tip");e.setting.eventTarget=this;c(this).addClass("JS_sock_tip");e.showModel();e.bindHideEvent();e.setPosition();if(e.setting.needAjax){e.loadData();}else{if(typeof e.setting.callback=="function"){e.setting.callback();}}f.stopPropagation();});},getHtml:function(){var d='<p style="text-align: center;"><img src="http://www.pinbot.me/static/alpha/images/loading.gif" alt="" style="vertical-align: -3px; margin-right:10px;">加载中...</p>';return d;},showModel:function(){c("#JS_tip_model").remove();var d="";if(this.setting.needAjax){d=this.getHtml();}else{d=this.setting.content;}d='<div class="tip-model '+this.setting.className+'" id="JS_tip_model" style="'+this.setting.cssText+'">'+d+"</div>";c("body").append(d);},setPosition:function(){var k=c(this.setting.eventTarget),m=k.offset(),n=k.outerWidth(),o=k.outerHeight(),r=c("#JS_tip_model"),d=r.outerWidth(),q=r.outerHeight(),h=c(window).width(),p=c(document).height(),e=c(document).scrollTop(),j=m.left+(n/2)+(d/2)+5>h,g=m.left+(n/2)-d/2<0,i=o+q+m.top+5>p,f,l;if(j&&i){l=m.top+o-q;f=m.left-5-d;r.addClass("right-bottom-side");}else{if(!j&&i&&!g){l=m.top-5-q;f=m.left+n/2-d/2;r.addClass("down-side");}else{if(j&&!i){l=m.top+o+5;f=m.left+n-d;r.addClass("right-top-side");}else{if(g&&!i){l=m.top-5;f=m.left+n+5;r.addClass("left-top-side");}else{if(g&&i){l=m.top+o-q;f=m.left+n+5;r.addClass("left-bottom-side");}else{l=m.top+o+5;f=m.left+n/2-d/2;}}}}}r.css({left:f+"px",top:l+"px"});},bindHideEvent:function(){var e=this,d=function(i){var h=c(e.setting.selector);if(i.target!=c("#JS_tip_model")[0]&&!c(i.target).closest("#JS_tip_model").length){var f=c(i.target),g=f.closest(".JS_sock_tip");if(f.hasClass("JS_sock_tip")){c(".JS_sock_tip").not(f).removeClass("JS_sock_tip");}else{if(g.length){c(".JS_sock_tip").not(g).removeClass("JS_sock_tip");}else{c(".JS_sock_tip").removeClass("JS_sock_tip");}}if(window._tipAjax){window._tipAjax.abort();window._tipAjax=null;}c(document).off("click",d);if(c.inArray(i.target,h)==-1){c("#JS_tip_model").remove();}}};c(document).on("click",document,d);},loadData:function(g){var e=this,i=c(g||e.setting.eventTarget),f=c.extend(true,{},i.data()),h=f.method?f.method:"get",d=f.url;delete f.url;e.setting.url=d;window._tipAjax=c[h](d,f,function(j){if(j){if(typeof e.setting.success=="function"){e.setting.success.apply(e,[j]);}else{e.insertHtml(j);}}});},insertHtml:function(m){var n=this,h=c("#JS_tip_model"),k="",f=m.data;if(!h.length){return false;}if(f.length){k+='<table cellpadding="0" cellspacing="0" class="ajax-tip-list" width="100%">';for(var g=0,d=f.length;g<d;g++){var o=f[g];k+="<tr>";for(var e in o){k+="<td>"+o[e]+"</td>";}k+="</tr>";}k+="</table>";}else{k+='<p class="text-center">暂无数据！</p>';}k+='<p class="tip-pages clearfix">';if(m.current>1){k+='<a class="JS_tip_page" href="javascript:;" data-url="'+this.setting.url+'" data-page="'+(m.current-1)+'">上一页</a>';}if(m.current<m.pages){k+='<a class="JS_tip_page" href="javascript:;" data-url="'+this.setting.url+'" data-page="'+(m.current+1)+'">下一页</a>';}k+="</p>";h.html(k);this.setPosition(n.setting.eventTarget);c(".JS_tip_page").on("click",function(){n.loadData(this);});if(typeof this.setting.callback=="function"){this.setting.callback();}}};b.prototype.init.prototype=b.prototype;return function(d){return b(d);};}(jQuery);