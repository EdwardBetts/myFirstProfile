Array.prototype.remove=function(a){if(isNaN(a)||a>this.length){return false;}for(var b=0,c=0;b<this.length;b++){if(this[b]!=this[a]){this[c++]=this[b];}}this.length-=1;};(function(){var e=angular.module("app.edit_resume",["app.config","ui.router","app.django","app.utils"]);var b=angular.injector(["app.django"]);var a=b.get("tmpl");var c=b.get("api");var d=b.get("static_url");e.config(["$stateProvider","$urlRouterProvider",function(g,f){f.otherwise("/show_tag/");g.state("showTag",{url:"/show_tag/",templateUrl:a("my_resume/show_tag.html"),controller:"showTag"});g.state("edit_gender",{url:"/edit_gender/",templateUrl:a("my_resume/select_gender.html"),controller:"editGender"});g.state("edit_city",{url:"/edit_city/",templateUrl:a("my_resume/select_city.html"),controller:"editCity"});g.state("edit_position_category",{url:"/edit_position_category/",templateUrl:a("my_resume/select_position_category.html"),controller:"editPositionCategory"});g.state("edit_category_tag",{url:"/edit_category_tag/:category",templateUrl:a("my_resume/select_category_tag.html"),controller:"editCategoryTag"});g.state("edit_work_years",{url:"/edit_work_years/",templateUrl:a("my_resume/select_workyears.html"),controller:"editWorkyears"});g.state("edit_degree",{url:"/edit_degree/",templateUrl:a("my_resume/select_degree.html"),controller:"editDegree"});g.state("edit_salary",{url:"/edit_salary/",templateUrl:a("my_resume/select_salary.html"),controller:"editSalary"});}]);e.controller("showTag",["$scope","$http","$state",function(f,h,g){f.static_url=d;f.go_job_rec=function(){window.location.href="/job/#/recommend_job_list/";};f.check_first_li=function(j){if(j%5==0){return true;}return false;};f.check_second_li=function(j){if(j%2==0){return true;}return false;};f.check_third_li=function(j){if(j%3==0){return true;}return false;};f.toggle_input_div=function(k){var j=$(k.target);$tag_input_div=$(".tag_input_div"),display=$tag_input_div.css("display");if(display!="none"){j.removeClass("minus");$tag_input_div.css("display","none");$("div.tag_input_div ul").css("display","none");$("div.tag_input_div input").val("");}else{j.addClass("minus");$tag_input_div.css("display","table");h.get("/my_resume/add_resume_tag/").success(function(l){f.allTags=l.data;});$("html, body").animate({scrollTop:$(document).height()},500);}};f.dropDown=function(l){$(".addTag").unbind("click").attr("isUse","unuse");f.workTags=[];var n=l,o=$(n.target),m=o.val();for(var k=f.allTags.length-1;k>=0;k--){var j=f.allTags[k].name.toLowerCase().indexOf(m.toLowerCase());if(j!=-1){f.workTags.push(f.allTags[k]);}}if(m!=""){$("div.tag_input_div ul").css("display","block");if(f.workTags.length!=0){$(".show_tag_form div.tag_input_div ul li.none_info").css("display","none");}else{$(".show_tag_form div.tag_input_div ul li.none_info").css("display","block");}}else{$("div.tag_input_div ul").css("display","none");}$("html, body").animate({scrollTop:$(".tag_input_div input").offset().top},500);};f.setValue=function(j){var m=j,l=$(m.target),k=l.html(),n=l.attr("id");f.tagName=k;$("div.tag_input_div ul").css("display","none");$(".addTag").attr("isUse","use").one("click",function(){$(".addTag").attr("isUse","unuse");h.post("/my_resume/add_resume_tag/",$.param({tag_id:n})).success(function(o){f.data.selected.category_tag=o.data;$(".addTag").attr("isUse","use");});});};f.isUnuse=function(){var j=$(".addTag"),k=$(".tag_input_div input");if(j.attr("isuse")!="unuse"||k.val()==""){return false;}return true;};f.delete_tag=function(l,j){f.data.selected.category_tag.remove(j);var k=c.resume.delete_resume_tag+l;h.get(k).success(function(m){console.log(m.status);});};f.show_delete_btn=function(m,l){var k=$("#"+m);var j=k.css("color");if(j=="rgb(255, 255, 255)"){k.css("background","#fff").css("color","#0091fa").find("img").show();}else{k.css("background","#0091fa").css("color","#fff").find("img").hide();}};h.get(c.resume.edit_resume_tag).success(function(k){f.data=k.data;if(f.data.selected.city.length>1){f.data.selected.city="意向城市";}else{for(var j=f.data.selected.city.length-1;j>=0;j--){f.data.selected.city=f.data.selected.city[j];}}f.data.selected.salary_lowest=f.data.selected.salary_lowest/1000+"K";});}]);e.controller("editGender",["$scope","$http","$state",function(f,h,g){f.gender="";f.static_url=d;f.setGender=function(j){f.gender=j;$("a").removeClass("checked");$("#"+f.gender).addClass("checked");$(".opt_part").css("display","block");};f.confirm=function(){h.post(c.resume.select_gender,$.param({gender:f.gender})).success(function(j){g.go("showTag");});};h.get(c.resume.select_gender).success(function(j){f.gender=j.data.gender;if(f.gender!=""){$("#"+f.gender).addClass("checked");}$("p").html('<a class="back"><img src="'+d+'my_resume/img/arrow_1_32x46.fw.png"/></a>请修改你的性别');$(".back").click(function(){g.go("showTag");});});}]);e.controller("editCity",["$scope","$http","$state",function(f,h,g){f.select_city=[];f.static_url=d;f.back=function(){g.go("showTag");};f.checkCity=function(k){var j=f.select_city.indexOf(k);if(j>=0){f.select_city.remove(j);$("."+k).removeClass("checked");}else{f.select_city.push(k);$("."+k).addClass("checked");}if(f.select_city.length!=0){$opt_part=$(".opt_part");$opt_part.css("display","block");if($opt_part.find("a").css("font-size")=="18px"&&$(".city_form ul li").css("margin-bottom")!="20px"&&$(".city_form ul ul").css("padding-bottom")!="20px"){$opt_part.find("a").css("padding","15px 0");}$("html, body").animate({scrollTop:$(document).height()},500);}else{$(".opt_part").css("display","none");}};f.confirm=function(){h.post(c.resume.select_city,$.param({city:f.select_city})).success(function(j){g.go("showTag");});};f.checked_area=function(k){for(var j=0;j<f.data.expectation_area.length;j++){if(f.data.expectation_area[j].city__id==k.id){return true;}}return false;};f.check_first=function(j){if(j%3==0){return true;}return false;};f.check_second=function(j){if(j%2!=0){return true;}return false;};h.get(c.resume.select_city).success(function(k){f.data=k.data;for(var j=0;j<f.data.expectation_area.length;j++){f.select_city.push(f.data.expectation_area[j].city__id);}$("p").html('<a class="back"><img src="'+d+'my_resume/img/arrow_1_32x46.fw.png"/></a>请修改求职意向地');$(".back").click(function(){g.go("showTag");});});}]);e.controller("editPositionCategory",["$scope","$http","$state",function(f,h,g){f.category="";f.static_url=d;f.check_selected=function(j){if(j==f.category){return true;}return false;};f.back=function(){g.go("show_tag");};f.setPosition=function(j){g.go("edit_category_tag",{category:j});};h.get(c.resume.select_position_category).success(function(j){f.data=j.data;f.category=j.data.category;$("p").html('<a class="back"><img src="'+d+'my_resume/img/arrow_1_32x46.fw.png"/></a>请修改职位');$(".back").click(function(){g.go("showTag");});});}]);e.controller("editCategoryTag",["$scope","$http","$state","$stateParams",function(f,k,g,h){f.tag=[];f.static_url=d;f.back=function(){g.go("edit_position_category");};f.previous=function(l){var o=l.level;if(o==1){g.go("edit_position_category");}else{var m=$(".checked").length;if(m!=0){var n=f.tag.indexOf(f.data.previous_tag.id);if(n<0){f.tag.push(f.data.previous_tag.id);}}else{var n=f.tag.indexOf(f.data.previous_tag.id);if(n>0){f.tag.remove(n);}}f.data.previous_tag.id=f.data.save_id;f.data.previous_tag.name=f.data.save_name;f.data.previous_tag.level=1;f.data.category_tag=f.data.save_tag;}};f.checkTag=function(l){var p=l.child?l.child.length:false;if(p){f.data.save_id=f.data.previous_tag.id;f.data.save_name=f.data.previous_tag.name;f.data.save_tag=f.data.category_tag;f.data.previous_tag.id=l.id;f.data.previous_tag.level=2;f.data.previous_tag.name=l.name;f.data.category_tag=l.child;}else{var o=f.tag.indexOf(l.id);var n=f.tag.indexOf(f.data.previous_tag.id);var m=f.data.previous_tag.level;if(o>=0){f.tag.remove(o);$("."+l.id).removeClass("checked");if($("a.checked").length==0){f.tag.remove(f.data.previous_tag.id);}}else{f.tag.push(l.id);$("."+l.id).addClass("checked");$("."+l.id).find("img").addClass("checked");if($(".checked").length!=0&&n<0&&m!=1){f.tag.push(f.data.previous_tag.id);}}if($("a.checked").length!=0){$opt_part=$(".opt_part");$opt_part.css("display","block");if($opt_part.find("a").css("font-size")=="18px"&&$(".city_form ul li").css("margin-bottom")!="20px"&&$(".city_form ul ul").css("padding-bottom")!="20px"){$opt_part.find("a").css("padding","15px 0");}$("html, body").animate({scrollTop:$(document).height()},500);}else{$(".opt_part").css("display","none");}}};f.confirm=function(){f.category=f.root_id;k.post(c.resume.edit_category_tag,$.param({tag:f.tag,category:f.category})).success(function(l){g.go("showTag");});};f.check_first=function(l){if(l%3==0){return true;}return false;};f.check_second=function(l){if(l%2!=0){return true;}return false;};f.check_selected=function(l){for(i in f.tag){if(l==f.tag[i]){return true;}}return false;};var j=c.resume.edit_category_tag+"?category="+h.category;k.get(j).success(function(m){f.data=m.data;for(var l=f.data.resume_tag.length-1;l>=0;l--){f.tag.push(f.data.resume_tag[l].position_tag__id);}f.root_id=f.data.previous_tag.id;$("p")[0].childNodes[1].data="请修改职位标签";});}]);e.controller("editWorkyears",["$scope","$http","$state",function(f,h,g){f.work_years="";f.static_url=d;f.back=function(){g.go("showTag");};f.setWorkyears=function(j){f.work_years=j;$("a").removeClass("checked");$("#"+f.work_years).addClass("checked");$(".opt_part").css("display","block");$("html, body").animate({scrollTop:$(document).height()},500);};f.confirm=function(){h.post(c.resume.select_workyears,$.param({work_years:f.work_years})).success(function(j){g.go("showTag");});};f.check_selected=function(j){if(j==f.work_years){return true;}return false;};h.get(c.resume.select_workyears).success(function(j){f.work_years=j.data.work_years;$("p").html('<a class="back"><img src="'+d+'my_resume/img/arrow_1_32x46.fw.png"/></a>请修改工作年限');$(".back").click(function(){g.go("showTag");});});}]);e.controller("editDegree",["$scope","$http","$state",function(f,h,g){f.degree="";f.static_url=d;f.back=function(){g.go("showTag");};f.setDegree=function(j){f.degree=j;$("a").removeClass("checked");$("#"+f.degree).addClass("checked");if($(".checked").length!=0){$(".opt_part").css("display","block");}$("html, body").animate({scrollTop:$(document).height()},500);};f.confirm=function(){h.post(c.resume.select_degree,$.param({degree:f.degree})).success(function(j){g.go("showTag");});};f.check_degree=function(k){for(var j=k.length-1;j>=0;j--){if(f.data.degree==k[j]){return true;}}return false;};h.get(c.resume.select_degree).success(function(j){f.data=j.data;$("p").html('<a class="back"><img src="'+d+'my_resume/img/arrow_1_32x46.fw.png"/></a>请修改你的学历');$(".back").click(function(){g.go("showTag");});});}]);e.controller("editSalary",["$scope","$http","$state",function(f,h,g){f.salary="";f.static_url=d;f.back=function(){g.go("showTag");};f.confirm=function(){if($(".error").css("display")=="none"){h.post(c.resume.select_salary_lowest,$.param({salary_lowest:f.salary+"000"})).success(function(j){if(j&&j.status=="ok"){g.go("showTag");}else{alert(j.msg);}}).error(function(){console.log("请求失败");});}};f.confrimShow=function(j){if($(".error").css("display")!="none"){return false;}return true;};f.showInfo=function(j){f.salary=j.target.value.replace(/[^\d]/g,"");if(f.salary!=0&&f.salary!=""){$(".error").css("display","none");$(".info span").html(f.salary*1000);$(".info").css("display","block");}else{if(f.salary==0||f.salary==0){$(".info").css("display","none");$(".error").css("display","block");}else{$(".info").css("display","none");}}};f.hideInfo=function(k){var j=k.target;$(j).parent().css("border","1px solid #d7d7d7");};f.addColor=function(k){var j=k.target;$(j).css("border-right",0).parent().css("border","1px solid #0091fa");};f.none=function(){return true;};f.focusInput=function(j){$(j.target).find("input").focus();};h.get(c.resume.select_salary_lowest).success(function(k){f.data=k.data;var j=f.data.salary_lowest;f.salary=j/1000;f.salary=f.salary==0?"":f.salary;if(f.data.salary_lowest!=0){$(".info span").html(f.salary*1000);$(".info").css("display","block");}});}]);})();
