$.LayerOut=function(a){return new $.LayerOut.prototype.init(a)},$.LayerOut.prototype={constructor:$.LayerOut,version:"1.1",init:function(a){$._LayerOut&&delete $._LayerOut,$(".modal-backdrop,.modal").remove(),this.setting=a=$.extend({title:"",html:"",dialogCss:"",isShowCloseBtn:!0,closeByShadow:!0,confirmByShadow:!1,handlers:[],callback:null,afterClose:null},a),$._LayerOut=this,$._LayerOut.getHtml(),void 0!=$._LayerOut&&void 0!=$._LayerOut.setting&&"function"==typeof $._LayerOut.setting.callback&&$._LayerOut.setting.callback()},getHtml:function(){setting=this.setting;var a='<div class="modal-backdrop fade in"></div><div class="modal" id="myModal" tabindex="-1" style="display: block;"><div class="modal-dialog" style="'+this.setting.dialogCss+'"><div class="modal-content" id="JS_modal_content">'+(this.setting.isShowCloseBtn?'<p class="close-layer text-right"><a href="javascript:;" class="close-layerout-btn JS_close_layerout"></a></p>':"")+(this.setting.title?'<div class="modal-header clearfix"><h4 class="modal-title Left" id="myModalLabel">'+this.setting.title+'</h4><span class="Right">'+(this.setting.date?this.setting.date:"")+"</span></div>":"")+'<div class="modal-body">'+this.setting.html+"</div></div></div></div>";if($("body").append(a),setting.handlers.length)for(var b=$('<div class="modal-handle"></div>'),c=0,d=setting.handlers.length;d>c;c++){var e=setting.handlers[c],f=$('<a class="'+e.className+'">'+e.title+"</a>");f.on(e.eventType,e.event),b.append(f)}$("#JS_modal_content").append(b);var g=$(".modal-dialog"),h=g.height(),i=$(window).height();g.css("marginTop",(i-h)/2+"px"),$(".JS_close_layerout").on("click",this.close);var j=this;$("#myModal").on("click",function(a){a=a||window.event;a.target||a.srcElement;a.target==this&&(setting.handlers.length&&setting.confirmByShadow?setting.handlers[0].event():setting.closeByShadow&&j.close())})},close:function(){$(".modal-backdrop,.modal").remove(),delete $._LayerOut,"function"==typeof setting.afterClose&&setting.afterClose()}},$.LayerOut.prototype.init.prototype=$.LayerOut.prototype,$.alert=function(a,b,c,d){var d=$.extend({title:c||"",html:a||"",handlers:[{title:"\u786e\u5b9a",eventType:"click",className:"button button-primary w158 f16",event:function(){"function"==typeof b&&b(),$._LayerOut.close()}}]},d);$.LayerOut(d)},$.confirm=function(a,b,c,d,e){var e=$.extend({title:d||"",html:a||"",handlers:[{title:"\u786e\u5b9a",eventType:"click",className:"button button-primary w158 f16",event:function(){"function"==typeof b&&b(),$._LayerOut.close()}},{title:"\u53d6\u6d88",eventType:"click",className:"button button-normal w158 f16",event:function(){"function"==typeof c&&c(),$._LayerOut.close()}}]},e);$.LayerOut(e)},jQuery.prototype.serializeObject=function(){var a=new Object;return $.each(this.serializeArray(),function(b,c){c.name in a||(a[c.name]=c.value)}),a},$.Click=function(a,b){var c=function(a){return new c.prototype.init(a)};return c.prototype={constructor:c,init:function(b){this.setting=a.extend({dom:"",before:null,isOk:!0,lock:!0,unlock:function(){a(this.setting.dom).removeClass("locked-click")},callback:null},b),a.Click.handleCaches=a.Click.eventCaches||[],a.Click.handleCaches.push({dom:this.setting.dom,clicker:this}),this.handle()},handle:function(){this.setting.lock&&a(this.setting.dom).addClass("locked-click"),"function"==typeof this.setting.before&&(this.setting.isOk=this.setting.before()),this.setting.isOk?this.setting.callback.call(this):this.setting.unlock.call(this)}},c.prototype.init.prototype=c.prototype,function(b){if(b&&b.dom&&!a(b.dom).hasClass("locked-click")){if(a.Click.handleCaches&&a.Click.handleCaches.length)for(var d=0,e=a.Click.handleCaches.length;e>d;d++){var f=a.Click.handleCaches[d];if(f.dom==b.dom)return void f.clicker.handle()}return c(b)}}}(jQuery),$.Ajax=function(a,b){var c=function(a){return new c.prototype.init(a)};return c.prototype={constructor:c,init:function(b){this.setting=b=a.extend({url:"",form:"",callDom:"",method:"post",isOk:!0,data:"",failed:function(){a.alert('<p style="text-align:center;font-size:16px;"><i class="i-l-notice"></i>\u8bf7\u6c42\u5931\u8d25\u4e86\uff0c\u5237\u65b0\u518d\u8bd5\u4e00\u4e0b\u5427\uff01</p>')},callback:function(b){b&&"ok"==b.status?a.alert('<p style="text-align:center;font-size:16px;"><i class="i-l-notice"></i>\u64cd\u4f5c\u6210\u529f\uff01</p>',function(){b.redirect_url&&(location.href=b.redirect_url)},"",{confirmByShadow:!0}):b&&b.msg?a.alert('<p style="text-align:center;font-size:16px;"><i class="i-l-notice"></i>'+b.msg+"</p>"):a.alert('<p style="text-align:center;font-size:16px;"><i class="i-l-notice"></i>\u8bf7\u6c42\u5931\u8d25\u4e86\uff0c\u5237\u65b0\u518d\u8bd5\u4e00\u4e0b\u5427\uff01</p>')},verify:null,after:null},b);var c=a(this.setting.form),d=this;this.setting.verify&&(this.setting.isOk=this.setting.verify()),c&&!this.setting.data&&(this.setting.data=a(this.setting.form).serializeObject()),this.setting.isOk?(this.setting.data.___=(new Date).getTime(),window._commonAjax=a[this.setting.method](this.setting.url,this.setting.data,function(a){d.setting.callback.call(d,a),d.unlock(),window._commonAjax=null}).fail(function(){d.setting.failed.call(d),d.unlock()})):d.unlock(),"function"==typeof this.setting.callback&&this.setting.callback()},unlock:function(){this.setting.callDom&&a(this.setting.callDom).removeClass("locked-click")}},c.prototype.init.prototype=c.prototype,function(a){return c(a)}}(jQuery),$.commonAjax=function(){window._commonAjax&&(window._commonAjax.abort(),window._commonAjax=null);var a=this,b=$(this),c=b.attr("data-before"),d=b.attr("data-ajax_common_type"),e=b.attr("data-ajax_verify"),f=b.attr("data-callback"),g=b.attr("data-after"),h=b.attr("data-method"),i=b.hasClass("locked-click"),j="",k="",l={callDom:a};return i?!1:("normal"==d?(k=b.attr("data-ajax_url"),h=h||"get",l.data=$.extend(!0,{},b.data()),delete l.data.ajax_url,delete l.data.before,delete l.data.ajax_common_type,delete l.data.ajax_verify,delete l.data.callback,delete l.data.method):(j=b.attr("data-form")?$(b.attr("data-form")):b.closest("form"),k=j.attr("data-ajax_url")||j.attr("action"),h=h||"post",l.form=j),e&&"function"==typeof window[e]&&(l.verify=function(){return window[e](j)}),f&&"function"==typeof window[f]&&(l.callback=window[f]),g&&"function"==typeof window[g]&&(l.after=window[g]),l.url=k,l.method=h,void $.Click({dom:a,before:window[c],callback:function(){$.Ajax(l)}}))},filterXss=function(a){if(a){var b=/<script>|<\/script>/gim,c=function(a,b){return a=a.replace(/</g,"&lt;"),a=a.replace(/>/g,"&gt;")};return a=a.replace(b,c)}},$.loadBgImg=function(a){a=$.extend({attr:"data-bg",loadImg:function(a,b){var c=new Image;c.onload=c.onerror=function(){a.css("backgroundImage","url("+b+")").removeAttr("data-bg"),c=null},c.src=b},imgList:[],callback:null},a),a.imgList.length||(a.imgList=$("["+a.attr+"]"));var b=a.imgList;if(b.length){for(var c=0;c<b.length;c++){var d=$(b[c]),e=d.attr(a.attr);e&&a.loadImg(d,e)}"function"==typeof a.callback&&a.callback()}},$.lazyImg=function(a){return new $.lazyImg.prototype.init(a)},$.lazyImg.prototype={constructor:$.lazyImg,imgList:[],loadingList:[],init:function(a){this.setting=$.extend({attr:"data-src",loadType:1,count:30,scrollLimit:30,isLock:!1,scrollTop:0,scrollBorder:60,callback:null},a),this.imgList=$("img["+this.setting.attr+"]"),window._lazy=this,this.getPositionByBody(),this.start(),$(window).on("scroll",window,window._lazy.scroll)},start:function(){for(var a=_lazy.getList(),b=0;b<a.length;b++){var c=a[b],d=$(c),e=d.attr(_lazy.setting.attr);_lazy.loadImg(d,e),_lazy.loadingList.push(c)}_lazy.resetImgFromImgList()},getList:function(){var a=[];if(1==_lazy.setting.loadType)for(var b=$(window).scrollTop(),c=$(window).height(),d=0;d<_lazy.imgList.length;d++){var e=$(_lazy.imgList[d]).offset().top;e<b+c+_lazy.setting.scrollBorder&&(a.push(_lazy.imgList[d]),_lazy.filterImg(d))}else for(var f=_lazy.imgList.length>this.setting.count?this.setting.count:_lazy.imgList.length,d=0;d<f.length;d++)a.push(_lazy.imgList[d]),_lazy.filterImg(d);return a},filterImg:function(a){_lazy.imgList[a].top=null,delete _lazy.imgList[a]},loadImg:function(a,b){var c=new Image;c.onload=c.onerror=function(){a.attr("src",b).removeAttr(_lazy.setting.attr),_lazy.clearImgFromLoadingList(a[0]),c=null},c.src=b},getPositionByBody:function(){for(var a=0;a<_lazy.imgList.length;a++){var b=$(_lazy.imgList[a]).offset().top;_lazy.imgList[a].top=b}},resetImgFromImgList:function(){for(var a=[],b=0;b<_lazy.imgList.length;b++){var c=_lazy.imgList[b];c&&a.push(c)}_lazy.imgList=a,_lazy.timmer()},clearImgFromLoadingList:function(a){for(var b=0;b<_lazy.loadingList.length;b++)if(_lazy.loadingList[b]==a)return void _lazy.loadingList.splice(b,1)},scroll:function(){return _lazy.setting.isLock?!1:(_lazy.setting.isLock=!0,_lazy.imgList&&_lazy.imgList.length?void _lazy.start():(window._lazy.complete(),!1))},timmer:function(){var a=function(){_lazy.setting.isLock=!1};tLazy=setTimeout(a,_lazy.setting.scrollLimit)},complete:function(){$(window).off("scroll",window._lazy.scroll),_lazy.setting.isLock=!1,tLazy&&clearTimeout(tLazy),"function"==typeof _lazy.setting.callback&&_lazy.setting.callback(),_lazy=null}},$.lazyImg.prototype.init.prototype=$.lazyImg.prototype;