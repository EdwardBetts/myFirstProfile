var emailReg=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/,options={rules:{username:{required:true,email:true}},messages:{username:{required:"邮箱不能为空！",email:"请输入正确格式的邮箱！"}}};function showResponse(b,c){$("#id_submit").removeAttr("disabled").removeClass("disabled");var a=b;if(a&&a.status&&a.status=="ok"){$(".reset_send_resp").html("您将会收到重置密码的电子邮件").parent().show();$(".reset_send_info").html("没收到激活邮件？请查看垃圾箱或<a>重新发送</a>").parent().show();$(".reset_send_info a").on("click",function(){var e=$(this);var d=$("[name = username]").val();$.ajax({type:"get",dataType:"json",url:"/account/send_reset_email/"+d,success:function(f){if(f&&f.status&&f.status=="ok"){$(".reset_resend_info").html("发送成功！").parent().show();}else{if(f&&f.status&&f.status=="malice"){$(".reset_send_resp").parent().css("display","none");$(".reset_resend_info").parent().css("display","none");$(".malice").html(f.msg).parent().show();e.css("color","#777777").css("border-bottom","1px solid #777777").unbind("click");}}},error:function(f){console.log(f.responseText);}});});}else{if(a&&a.status&&a.status=="malice"){$("button[type=submit]").attr("disabled","disabled").css("background","#ccc");$(".malice").html("提交得太频繁啦，休息一会再试吧！").parent().show();}else{if(a&&a.status&&a.status=="not_found_user"){$(".malice").html(a.msg).parent().show();}}}}function showRequest(d,c,b){var a=$("#forgetForm").valid();if(a){$("#id_submit").attr("disabled","disabled").addClass("disabled");}return a;}$(document).ready(function(){validator=$("#forgetForm").validate(options);$("#id_submit").click(function(){validator.form();var b=$("[name = username]").val();var a=$("[name = csrfmiddlewaretoken]").val();$(this).ajaxSubmit({type:"get",url:"/account/send_reset_email/"+b,dataType:"json",data:{username:b,csrfmiddlewaretoken:a},beforeSubmit:showRequest,success:showResponse,error:function(c){$("#id_submit").removeAttr("disabled").removeClass("disabled");console.log(c.responseText);}});});$(document).on("keyup",function(a){if(a.keyCode==13){$("#id_submit").trigger("click");}});});$("input").on("focus",function(){$(".tips").each(function(){$(this).parent().css("display","none");});$("button[type=submit]").removeAttr("disabled").css("background","#0091fa");});