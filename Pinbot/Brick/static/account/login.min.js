var emailReg=/^([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+@([a-zA-Z0-9]+[_|\_|\.]?)*[a-zA-Z0-9]+\.[a-zA-Z]{2,3}$/,options={rules:{username:{required:true,email:true},password:{required:true}},messages:{username:{required:"邮箱不能为空！",email:"请输入正确格式的邮箱！"},password:{required:"请输入密码！"}}};function showResponse(b,c){$("#id_submit").removeAttr("disabled").removeClass("disabled");var a=b;if(a&&a.status&&a.status=="ok"){window.location.href=a.redirect_url;}else{if(a&&a.status&&a.status=="malice_ip"){$("button[type=submit]").attr("disabled","disabled").css("background","#ccc");$(".result").html("提交得太频繁啦，休息一会再试吧！").parent().show();}else{if(a&&a.status&&a.status=="not_exist"){$(".login_tip_info").html(a.msg).parent().show();}else{if(a&&a.status&&a.status=="not_active"){$(".login_tip_info").html(a.msg).parent().show();$(".active_span").html("没有收到激活邮件？<a>重新发送</a>").parent().show();$(".active_span a").on("click",function(){var e=$(this);var d=$("[name = username]").val();$.ajax({type:"get",dataType:"json",url:"/account/send_active_email/"+d,success:function(f){if(f&&f.status&&f.status=="ok"){$(".active_send_resp").html(f.msg).parent().show();}else{if(f&&f.status&&f.status=="malice"){$(".active_send_resp").html(f.msg).parent().show();e.css("color","#777777").css("border-bottom","1px solid #777777").unbind("click");}}},error:function(f){console.log(f.responseText);}});});}else{if(a&&a.errors){}}}}}}function showRequest(d,c,b){var a=$("#loginForm").valid();if(a){$("#id_submit").attr("disabled","disabled").addClass("disabled");}return a;}$(document).ready(function(){validator=$("#loginForm").validate(options);$("#id_submit").click(function(){var b=$(this);validator.form();var d=$("[name = username]").val();var a=$("[name = password]").val();var c=$("[name = csrfmiddlewaretoken]").val();b.ajaxSubmit({type:"post",dataType:"json",data:{username:d,password:a,csrfmiddlewaretoken:c},beforeSubmit:showRequest,success:showResponse,error:function(e){$("#id_submit").removeAttr("disabled").removeClass("disabled");console.log(e.responseText);}});});$(document).on("keyup",function(a){if(a.keyCode==13){$("#id_submit").trigger("click");}});});$("input").on("focus",function(){$(".login_tip_info").parent().css("display","none");$(".active_span").parent().css("display","none");$(".active_send_resp").parent().css("display","none");$("button[type=submit]").removeAttr("disabled").css("background","#0091fa");$(".result").parent().hide();});