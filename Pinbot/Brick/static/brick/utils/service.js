!function(){var t=angular.module("app.utils",["ng"]);t.factory("id_url",function(){return function(t,e){return t+e+"/"}}),t.factory("open_select",function(){return function(t){var e=$(t)[0],n=!1;if(document.createEvent){var o=document.createEvent("MouseEvents");o.initMouseEvent("mousedown",!0,!0,window,0,0,0,0,0,!1,!1,!1,!1,0,null),n=e.dispatchEvent(o)}else e.fireEvent&&(n=e.fireEvent("onmousedown"))}}),t.value("mockTest",!1),t.value("mockTestWithCoin",!1),t.factory("inArray",function(){return function(t,e){for(var n=0,o=e.length;o>n;n++)if(t==e[n])return!0;return!1}}),t.factory("confirmBox",function(){return function(t,e,n,o,a,i){var r="string"==typeof t&&t.match(/[<>]/i)?'<h3 class="text-center">'+t+"</h3>":'<h3 class="text-center"><i class="i-ms"></i>'+t+"</h3>";return'<div class="mission-success pay-mission-success">'+r+'<div class="c607d8b f14 text-center clearfix">'+e+'</div><p class="mt20 text-center"><a class="btn btn-default btn-pay-problem" href="javascript:void(0);">'+n+'</a><a class="btn btn-blue btn-pay-ok" href="javascript:void(0);">'+a+"</a></p></div>"}}),t.factory("confirmBoxRed",function(){return function(t,e,n,o,a,i){var r="string"==typeof t&&t.match(/[<>]/i)?'<h3 class="text-center">'+t+"</h3>":'<h3 class="text-center"><i class="i-ms"></i>'+t+"</h3>";return'<div class="mission-success pay-mission-success">'+r+'<div class="annotation annotation-star f14 text-center clearfix">'+e+'</div><p class="mt20 text-center"><a class="btn btn-default btn-pay-problem" href="javascript:void(0);">'+n+'</a><a class="btn btn-red btn-pay-ok" href="javascript:void(0);">'+a+"</a></p></div>"}}),t.factory("alertBox",function(){return function(t,e,n,o,a,i){var r=void 0!=e&&"string"==typeof e&&""!=e?'<span class="annotation annotation-star">'+e+"</span>":"",s=void 0!=t&&"string"==typeof t&&t.match(/[<>]/i)?'<h3 class="text-center">'+t+"</h3>":'<h3 class="text-center"><i class="i-ms"></i>'+t+"</h3>",c=n.match(/<(div|p) /i)?n:'<p class="c607d8b f14 text-center pd-bottom-20">'+n+"</p>",i=void 0!=i&&"string"==typeof i?"red":"blue";return'<div class="mission-success pay-mission-success">'+s+r+c+'<p class="mt20 text-center"><a class="btn btn-'+i+' btn-click-ok" href="javascript:void(0);">'+o+"</a></p></div>"}}),t.factory("alertBoxRed",function(){return function(t,e,n,o,a){var i=""==e?"":'<span class="annotation annotation-star">'+e+"</span>",r="string"==typeof t&&t.match(/[<>]/i)?'<h3 class="text-center">'+t+"</h3>":'<h3 class="text-center"><i class="i-ms"></i>'+t+"</h3>";return'<div class="mission-success pay-mission-success">'+r+i+'<p class="c607d8b f14 text-center pd-bottom-20">'+n+'</p><p class="mt20 text-center"><a class="btn btn-red btn-click-ok" href="javascript:void(0);">'+o+"</a></p></div>"}}),t.factory("getModeData",["mockTest","$q",function(t,e){return function(t,n,o,a,i,r,s,c){var c=void 0!=c?c:{},s=void 0!=s?!0:!1,p=e.defer();void 0===n&&(n="");var l=function(t,e,n,o,a){t.match(/^\/vip\/(self|manual)\/info/i)&&void 0!=n.status&&"ok"==n.status?("string"==typeof e&&""!=e&&(window.location.hash=e),"function"==typeof o&&o(n)):a||void 0==n.status||"ok"==n.status||1==n.status||0==n.status?n&&n.count>0?("string"==typeof e&&""!=e&&(window.location.hash=e),"function"==typeof o&&o(n)):("ok"==n.status||1==n.status||0==n.status)&&0==n.status?n.data?"function"==typeof o&&o(n):n.msg?$.alert('<p class="alert-notice-center"><span>请求错误提示：'+n.msg.toString()+"</span></p>"):n.error?$.alert('<p class="alert-notice-center"><span>请求错误提示：'+n.error.toString()+"</span></p>"):$.alert('<p class="alert-notice-center"><span>请求错误！</span></p>'):("string"==typeof e&&""!=e&&(window.location.hash=e),"function"==typeof o&&o(n)):n.msg?$.alert('<p class="alert-notice-center"><span>请求错误提示：['+n.msg.toString()+"]</span></p>"):n.error?$.alert('<p class="alert-notice-center"><span>请求错误提示：['+n.error.toString()+"]</span></p>"):$.alert('<p class="alert-notice-center"><span>请求错误！</span></p>')};if(void 0!=i&&i===!0){if("string"==typeof o&&""!=o&&(window.location.hash=o),"function"==typeof a){var u=c;n.match(/^\/vip\/get_self_service_select\/$/i)?u={}:n.match(/^\/vip\/get_manual_service_select\/$/i)&&(u={}),l(n,o,u,a,s)}return null}var f=t.get(n,{cache:!1}).success(function(t){pbDebug&&console.log("getModeData",n,o,t),loading=!1,l(n,o,t,a,s)}).error(function(t){"function"==typeof r&&r(t);var e=function(t){void 0!=t.msg&&"string"==typeof t.msg&&t.msg.match(/[<>]/i)?$.alert('<p class="alert-notice-center"><span>请求失败，请稍后再试！</span></p>'):$.alert('<p class="alert-notice-center"><span>请求失败，请稍后再试！</span></p>')};throw e(t.msg&&"string"==typeof t.msg?t:t),new Error("请求数据失败! ["+t.toString()+"]")});return f.abort=function(){p.resolve()},f}}]),t.factory("postModeData",["mockTest","$q",function(t,e){return function(n,o,a,i,r,s,c,p){var l=e.defer();void 0===a&&(a="");var p=void 0!=p&&"string"==typeof p&&"post"!=p?"json":"post",u=function(t){var e="";if("post"==p)for(var n in t)e+=""==e?""+n+"="+encodeURIComponent(t[n]):"&"+n+"="+encodeURIComponent(t[n]);else e=angular.toJson(t);return e},f={headers:{"Content-Type":"json"==p?"application/json":"application/x-www-form-urlencoded; charset=UTF-8"},transformRequest:u};if(t||void 0!=s&&s===!0){if("string"==typeof i&&""!=i&&(window.location.hash=i),"function"==typeof r)if(a.match(/coin_paid_order/i)&&!o.hasOwnProperty("product_type"))r({status:"ok",msg:"订单支付成功",order_id:1075});else if(o.product_type.match(/self_service/i)){var d="alipay";"coin"==o.payment_terms&&(d="coin"),r({status:"ok",msg:"订单生成成功",pay_url:"https://mapi.alipay.com/gateway.do",order_id:1075,payment_terms:d})}else r({status:"ok",msg:"订单生成成功",pay_url:"",order_id:1075,payment_terms:""});return null}var g=n.post(a,o,f).success(function(t){var e="";"支付失败,请勿重新购买!"==t.msg&&(e="<br>注：自助型用户请选择更高的级别的套餐，省心型用户不能同时购买自助服务"),loading=!1,a.match(/^\/vip\/(self|manual)\/info/i)&&void 0!=t.status&&"ok"==t.status?("string"==typeof i&&""!=i&&(window.location.hash=i),"function"==typeof r&&r(t)):void 0!=t.status&&"ok"!=t.status&&1!=t.status?$.alert('<p class="alert-notice-center"><span>提交错误提示：['+t.msg+"]"+e+"</span></p>"):t&&t.count>0?("string"==typeof i&&""!=i&&(window.location.hash=i),"function"==typeof r&&r(t)):"ok"==t.status||1==t.status?("string"==typeof i&&""!=i&&(window.location.hash=i),"function"==typeof r&&r(t)):$.alert('<p class="alert-notice-center"><span>提交错误提示：['+t.msg+"]"+e+"</span></p>")}).error(function(t){"function"==typeof c&&c(t);var e=function(t){void 0!=t.msg&&"string"==typeof t.msg&&t.msg.match(/[<>]/i)?$.alert('<p class="alert-notice-center"><span>请求失败，请稍后再试！</span></p>'):$.alert('<p class="alert-notice-center"><span>请求失败，请稍后再试！</span></p>')};throw e(t.msg&&"string"==typeof t.msg?t:t),new Error("提交数据失败! ["+t.toString()+"]")});return g.abort=function(){l.resolve()},g}}]),t.factory("pbFunc",["getModeData","postModeData","confirmBox","confirmBoxRed","alertBox","alertBoxRed",function(t,e,n,o,a,i){return{minPrice:function(t,e,n){for(var o in e)void 0!=e[o].is_show?1==e[o].is_show&&void 0!=e[o].price&&parseFloat(e[o].price)>0&&0==parseInt(t[n])?t[n]=e[o].price:1==e[o].is_show&&void 0!=e[o].price&&parseFloat(e[o].price)>0&&parseFloat(e[o].price)<parseInt(t[n])&&(t[n]=e[o].price):void 0!=e[o].price&&parseFloat(e[o].price)>0&&0==parseInt(t[n])?t[n]=e[o].price:void 0!=e[o].price&&parseFloat(e[o].price)>0&&parseFloat(e[o].price)<parseInt(t[n])&&(t[n]=e[o].price)},updateUserModeList:function(t,e,n,o,a){t.choosedModeList=n.data,e.modeList=t.choosedModeList,e.loadingThis=!1,"function"==typeof o&&o(a)},createOrder:function(t,n,o,a,i,r){e(t,a,"/vip/create_user_order/","",function(t){void 0!=t.status&&"ok"==t.status?"function"==typeof i&&i(r):o.alert('<p class="alert-notice-center"><span>创建订单失败，请稍后再试！['+t.msg+"]</span></p>"),n.loadingThis=!1})},loadApiUrl:function(t,e,n){for(var n="number"!=typeof n?1:n,o=t.api_params.length,a="?page="+n+"&",i=0;o>i;i++){var r=t.api_params[i];a+=r+"="+t.api_params_values[r]+"&"}return e+a},reloadList:function(e,n,o){t(e,this.loadApiUrl(n,n.api_url),"",function(t){n.loadingThis=!1,o.logList=t,n.logList=o.logList})},nextPage:function(e,n,o,a,i){n.loadingThis=!0,t(e,this.loadApiUrl(n,n.api_url,i),"",function(t){n.loadingThis=!1,a.logList=t,n.logList=a.logList,i>n.logList.pages&&(i=n.logList.pages),1>i&&(i=1),o(".offset-start").text((parseInt(n.logList.current)-1)*parseInt(n.logList.per_page)+1);var e=parseInt(n.logList.current)*parseInt(n.logList.per_page);n.logList.count<e?o(".offset-end").text(n.logList.count):o(".offset-end").text(e)})},orderAct:function(t,n,o,a,i,r,s){var c=this,p=o(i.currentTarget),l={service_id:p.attr("data-oid")};if(r.match(/^\/vip\/order\/delete\/$/i))var l={service_id:p.attr("data-oid")};n.loadingThis=!0,e(t,l,r,"",function(e){void 0!=e.status&&"ok"==e.status?(c.reloadList(t,n,a),"function"==typeof s&&s(e)):(n.loadingThis=!1,o.alert('<p class="alert-notice-center"><span>操作失败，请稍后再试！['+e.msg+"]</span></p>"))})},orderActGet:function(e,n,o,a,i,r,s){var c=this;n.loadingThis=!0,t(e,r,"",function(t){void 0!=t.status&&"ok"==t.status?(c.reloadList(e,n,a),"function"==typeof s&&s(t)):(n.loadingThis=!1,o.alert('<p class="alert-notice-center"><span>操作失败，请稍后再试！['+t.msg+"]</span></p>"))})},orderActConfirm:function(t,e,n,a,i,r,s,c,p){n.LayerOut({html:o(a,i,r,"",s,""),afterClose:function(){}}),n(".modal").undelegate(".btn-pay-problem").delegate(".btn-pay-problem","click",function(t){n._LayerOut.close(),"function"==typeof c&&c()}),n(".modal").undelegate(".btn-pay-ok").delegate(".btn-pay-ok","click",function(t){n._LayerOut.close(),"function"==typeof p&&p()})},orderActAlert:function(t,e,n,o,a,r,s,c){n.LayerOut({html:i(o,a,r,s),afterClose:function(){}}),$.Menu(),n(".modal").undelegate(".btn-click-ok").delegate(".btn-click-ok","click",function(t,e){n._LayerOut.close(),"function"==typeof c&&c()})},pbAlert:function(t,e,n,o,i,r,s,c){n.LayerOut({html:a(o,i,r,s),afterClose:function(){}}),n(".modal").undelegate(".btn-click-ok").delegate(".btn-click-ok","click",function(t,e){n._LayerOut.close(),"function"==typeof c&&c()})},currentDiySet:function(t,e,n){for(var o=0,a=n.length;a>o;o++)if(n[o].pid==e){t.feed_count=n[o].feed_count,t.pinbot_point=n[o].pinbot_point,t.name=n[o].name;break}},currentNoworrySet:function(t,e,n){for(var o=0,a=n.length;a>o;o++)if(n[o].pid==e){t.salary_range=n[o].salary_range,t.service_month=n[o].service_month,t.candidate_num=n[o].candidate_num;break}},canBuyDiy:function(t,e,n){for(var o=0,a=0,i=0,r=e.length;r>i;i++)if(e[i].pid==t){o=e[i].price;break}for(var i=0,r=e.length;r>i;i++)if(e[i].pid==n){a=e[i].price;break}return console.log("canBuyDiy",t,e,n,o,a),o>a?!0:!1},getUserData:function(e,n,o){t(e,"/vip/get_user_info/","",function(t){return void 0!=t.status&&"ok"==t.status?("function"==typeof n&&n(t),t):("function"==typeof o&&o(),null)})},getOrderStatus:function(t,n,o,a){var i={order_id:n};e(t,i,"/vip/order/get_order_status/","",function(t){return void 0!=t.status&&"ok"==t.status?("function"==typeof o&&o(t),t):("function"==typeof a&&a(),null)})},formatDate:function(t,e){var n=void 0!=e&&"number"==typeof e?new Date(e):new Date,o={"M+":n.getMonth()+1,"d+":n.getDate(),"h+":n.getHours(),"m+":n.getMinutes(),"s+":n.getSeconds(),"q+":Math.floor((n.getMonth()+3)/3),S:n.getMilliseconds()};(/(y+)/.test(t)||/(Y+)/.test(t))&&(t=t.replace(RegExp.$1,(n.getFullYear()+"").substr(4-RegExp.$1.length)));for(var a in o)o.hasOwnProperty(a)&&new RegExp("("+a+")").test(t)&&(t=t.replace(RegExp.$1,1==RegExp.$1.length?o[a]:("00"+o[a]).substr((""+o[a]).length)));return t},getDateObj:function(t){var e;return e=void 0!=t&&("string"==typeof t||"number"==typeof t)?new Date(t):new Date,{y:e.getFullYear(),m:e.getMonth()+1,d:e.getDate(),h:e.getHours(),i:e.getMinutes(),s:e.getSeconds()}},getTimestamp:function(t){var e=new Date(t);return Math.round(e.getTime()/1e3)},getTimestampMs:function(t){var e=new Date(t);return Math.round(e.getTime())},countDaysByMonth:function(t,e){var n=new Date(t),o=this.getDateObj(t),a=new Date(o.y,o.m-1+e,o.d,o.h,o.i,o.s),i=(a-n)/864e5;return i},getExpiredDateArr:function(t,e){var n=(new Date(t),this.getDateObj(t)),o=new Date(n.y,n.m-1+e,n.d,n.h,n.i,n.s),a=this.getTimestampMs(o);return[a,this.formatDate("yyyy-MM-dd hh:mm:ss",a)]},getDataWithPromise:function(e,n,o){var a=e.defer();return t(n,o,"",function(t){a.resolve(t)},void 0,function(t){a.reject(t)}),a.promise},urlString:function(t){var e="";for(var n in t)e+=""==e?""+n+"="+t[n]:"&"+n+"="+t[n];return e},alertModal:function(t,e,n,o,a,i,r){var i=void 0!=i&&"string"==typeof i?i:"",r=void 0!=r&&"string"==typeof r?r:"";return'<div class="mission-success pay-mission-success"><h3 class="text-center"><i class="i-ms"></i>'+t+'</h3><div class="c607d8b f14 text-center pd-bottom-20 clearfix">'+n+"</div>"+r+'<div class="mt20 text-center clearfix"><a class="btn btn-blue btn-click-ok '+i+'" href="javascript:void(0);">'+o+"</a></div></div>"},simpleAlert:function(t,e,n,o,i,r,s){var i=void 0!=i&&"string"==typeof i?i:"确定",r=void 0!=r&&1==r?'<span class="pay-alert"></span>':"",s=void 0!=s&&"string"==typeof s?"red":"blue";$.LayerOut({html:a(r+'<span class="pay-title">'+t+"</span>","",e,i,null,s),afterClose:function(){"function"==typeof n&&n(o)}}),$(".modal").undelegate(".btn-click-ok").delegate(".btn-click-ok","click",function(t){"function"==typeof n&&n($(this),o),$._LayerOut.close()})},simpleConfirm:function(t,e,a,i,r,s,c,p,l){var r=void 0!=r&&"string"==typeof r?r:"确定",s=void 0!=s&&1==s?'<span class="pay-alert"></span>':"",u=void 0!=l&&"red"==l?o:n;$.LayerOut({html:u(s+'<span class="pay-title">'+t+"</span>",e,r,"",c,""),afterClose:function(){}}),$(".modal").undelegate(".btn-pay-problem").delegate(".btn-pay-problem","click",function(t){"function"==typeof a&&a($(this),i)}),$(".modal").undelegate(".btn-pay-ok").delegate(".btn-pay-ok","click",function(t){"function"==typeof p&&p($(this),i)})},feedZero:function(t){return void 0!=t&&t.toString().match(/^[0-9]+$/i)&&parseInt(t)<10?"0"+parseInt(t):t},openQQ:function(t){console.log("openQQ",t,jQuery),"undefined"!=typeof jQuery&&$.getScript("http://wpa.b.qq.com/cgi/wpa.php").done(function(){BizQQWPA.addCustom([{aty:"0",nameAccount:"800031490",selector:t}])})},objToArr:function(t){var e=[];if("object"!=typeof t)return e;for(var n in t)e.push(t[n]);return e}}}]),t.factory("orderPay",["getModeData","postModeData","confirmBox",function(t,e,n){return function(t,o,a,i,r,s,c,p,l){var c=void 0!=c&&"string"==typeof c?c:"/vip/create_user_order/",u=window.open("about:blank");u.document.write('<meta charset="utf-8"><img src="/static/partner/images/loading.gif" alt="loading"><br>页面装载中...'),e(a,r,c,"",function(r){if(void 0!=r.status&&"ok"==r.status)if(void 0!=r.payment_terms&&"coin"==r.payment_terms){u.close();var c={order_id:r.order_id};e(a,c,"/vip/coin_paid_order/","",function(t){void 0!=t.status&&"ok"==t.status?o.go(s,{}):i.alert('<p class="alert-notice-center"><span>支付金币失败，请稍后再试！［'+t.msg+"］</span></p>")})}else{r.pay_url;"alipay"==r.payment_terms&&"string"==typeof r.pay_url&&r.pay_url.match(/^https?:\/\//i)?u.location.href=r.pay_url:u.close(),i.LayerOut({html:n('<span class="pay-alert"></span><span class="pay-title">请在新开页面上完成付款，付款完成前请勿关闭此窗口！</span>',"完成付款后请点击","支付遇到问题","","我已完成付款",""),afterClose:function(){}}),i(".modal").undelegate(".btn-pay-problem").delegate(".btn-pay-problem","click",function(t){i(".header h1").html('<span class="pay-failed"></span>Sorry...支付失败'),i(".header .sub-title").html('您未成功支付，若支付成功请尝试刷新页面。遇到问题？<a href="javascript:void(0);" id="JS_pbqqdiy_btn">联系聘宝人才顾问</a>'),i._LayerOut.close(),i.Menu()}),i(".modal").undelegate(".btn-pay-ok").delegate(".btn-pay-ok","click",function(t){var n={order_id:r.order_id};e(a,n,"/vip/order/get_order_status/","",function(t){void 0!=t.status&&"ok"==t.status&&"paid"==t.order_status?(i._LayerOut.close(),void 0!=s&&"string"==typeof s&&o.go(s,{})):void 0!=l&&"string"==typeof l?o.go(l,{}):(i.alert('<p class="alert-notice-center"><span>抱歉，您的支付尚未成功！</span></p>'),i(".header h1").html('<span class="pay-failed"></span>Sorry...支付失败'),i(".header .sub-title").html('您未成功支付，若支付成功请尝试刷新页面。遇到问题？<a href="javascript:void(0);" id="JS_pbqqdiy_btn">联系聘宝人才顾问</a>'),i.Menu())})})}else u.close(),i.alert('<p class="alert-notice-center"><span>创建订单失败，请稍后再试！['+r.msg+"]</span></p>");t.loadingThis=!1},void 0,void 0,p)}}]),t.factory("pbLib",[function(){return{setCookie:function(t,e,n){var n=void 0!=n&&"number"==typeof n?n:864e5,o=new Date;o.setTime(o.getTime()+n),document.cookie=t+"="+e+";expires="+o.toUTCString()+";path=/;"},delCookie:function(t){var e=new Date;e.setTime(e.getTime()-86400),document.cookie=t+"=;expires="+e.toUTCString()+";path=/;"},getCookie:function(t){var e=document.cookie.match("(^|;) ?"+t+"=([^; ]*)(;|$)");return e?e[2]:null},utf8_to_b64:function(t){return window.btoa(unescape(encodeURIComponent(t)))},b64_to_utf8:function(t){var t=t.replace(/\s/g,"");return decodeURIComponent(escape(window.atob(t)))},stopBubble:function(t){t=t?t:window.event,window.event&&(t.cancelBubble=!0),t.stopPropagation()},getFeedIdByUrl:function(){var t="0";return document.location.href.toString().match(/\/#\/feed_resume\/([0-9a-z]+)\//i)&&(t=RegExp.$1),t},feedCkPrefix:"fdc_",getFeedConfig:function(t){var e={};if(void 0===e[t]&&(e[t]={l:null,p:null,t:null,e:null,r:null,minY:"",maxY:"",minS:"",maxS:"",degree:"",minA:"",maxA:"",gender:"",ca:""}),"0"!=t&&null!=this.getCookie(this.feedCkPrefix+t)){var n=angular.fromJson(this.b64_to_utf8(this.getCookie(this.feedCkPrefix+t)));e[t].l=n.l,e[t].p=n.p,e[t].t=n.t,e[t].e=n.e,e[t].r=n.r,e[t].minY=n.minY,e[t].maxY=n.maxY,e[t].minS=n.minS,e[t].maxS=n.maxS,e[t].degree=n.degree,e[t].minA=n.minA,e[t].maxA=n.maxA,e[t].gender=n.gender,e[t].ca=n.ca}return e},setFeedConfig:function(t,e){var n=t.getFeedId,o=function(t,e,n,o){"object"==typeof n&&void 0!=n[o]&&null!=n[o]&&(t.choosedFeeds[e][o]=n[o])};"0"!=n&&void 0!=t.choosedFeeds[n]&&(o(t,n,e,"l"),o(t,n,e,"p"),o(t,n,e,"t"),o(t,n,e,"e"),o(t,n,e,"r"),o(t,n,e,"minY"),o(t,n,e,"maxY"),o(t,n,e,"minS"),o(t,n,e,"maxS"),o(t,n,e,"degree"),o(t,n,e,"minA"),o(t,n,e,"maxA"),o(t,n,e,"gender"),o(t,n,e,"ca"),this.setCookie(this.feedCkPrefix+n,this.utf8_to_b64(angular.toJson(t.choosedFeeds[n])),2592e5))},isEmptyObj:function(t){if("object"!=typeof t)return!1;var e=0;for(var n in t)if(void 0!=t[n]){e++;break}return 0==e?!0:!1}}}])}();